# Thread events

#### CreateThread and TerminateThread

Thread events notify the creation (`CreateThread`) or termination (`TerminateThread`) of threads within the process' address space. In situations where a process spawns a remote thread that runs in other process' address space, the `CreateThread` event is also triggered.
Thread events are comprised of the following parameters:

- `pid` identifies the process where the thread was created. If this value is not equal to the `pid` of the process generating the event, then the thread is created in remote process.
- `tid` represents the identifier of the freshly spawn thread.
- `base_prio` is the scheduler priority of the thread.
- `page_prio` is a memory page priority hint for memory pages accessed by the thread.
- `io_prio` represents an I/O priority hint for scheduling I/O operations generated by the thread.
- `ustack_base` is the base address of the thread's user space stack.
- `ustack_limit` is the limit of the thread's user space stack.
- `kstack_base` is the base address of the thread's kernel space stack.
- `kstack_limit` is the limit of the thread's kernel space stack.
- `start_address` is the start address of the function to be executed by the thread.
- `start_address_symbol` the symbol the represents the thread start address (e.g. `LoadLibraryEx`). Only present in `CreateThread` events.
- `start_address_module` the module that maps to the thread start address (e.g. `ntdll.dll`). Only present in `CreateThread` events.
- `teb` is the address of the Thread Environment Block (TEB).


#### OpenThread

`OpenProcess` event is triggered when a process opens an existing local thread object. This event contains the following parameters:

- `desired_access` is the hexadecimal value that represents the desired access to the thread object.
- `desired_access_names` is the list of human-readable desired access strings (e.g. `QUERY_LIMITED_INFORMATION`). For a full list and detailed explanation of available access rights, head to the official [docs](https://docs.microsoft.com/en-us/windows/win32/procthread/thread-security-and-access-rights).
- `name` is the name of the local process whose thread object was open.
- `exe` is the full path of the local process image whose thread object was open.
- `pid` is the identifier of the local process whose thread object was opened.
- `tid` is the identifier of the local thread that was opened.
- `status` contains the result of the thread object open operation. (e.g. `Success`)

#### SetThreadContext

`SetThreadContext` sets the thread context. Thread context represents the set of CPU registers.

- `status` contains the result of operation. (e.g. `Success`)

## Thread pool events {docsify-ignore}

A thread pool is a collection of worker threads that efficiently execute asynchronous callbacks on behalf of the application. The thread pool is primarily used to reduce the number of application threads and provide management of the worker threads.


#### SubmitThreadpoolWork

Enqueues the work item to the thread pool. This event has the following parameters:

- `pool_id` represents the thread pool identifier.
- `task_id` represents the thread pool task identifier.
- `callback` represents the address of the callback function.
- `context` represents the address of the callback context.
- `subprocess_tag` represents the thread pool identifier.
- `pool_id` represents the service identifier associated with the thread pool.
- `callback_symbol` represents the callback symbol (e.g. `RtlCaputreContext`)
- `callback_module` represents the module containing the callback symbol (e.g. `C:\Windows\System32\ntdll.dll`)
- `context_rip` represents the value of instruction pointer contained in the callback context.
- `context_rip_symbol` represents the symbol name associated with the instruction pointer in callback context.
- `context_rip_module` represents the module name associated with the instruction pointer in callback context.


#### SubmitThreadpoolCallback

Submits the thread pool callback for execution within the work item. This event has the same parameter set as the `SubmitThreadpoolWork` events.


#### SetThreadpoolTimer

Sets the thread pool timer object. This event consists of the following parameters:

- `duetime` represents the timer due time.
- `subqueue` represents the memory address of the timer subqueue.
- `timer` represents the memory address of the timer object.
- `period` represents the period of the timer.
- `window` represents the timer tolerate period.
- `absolute` indicates if the timer is absolute or relative.

